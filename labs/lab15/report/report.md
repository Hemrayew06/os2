---
## Front matter
title: "Отчёт по лабораторной работе №15"
subtitle: "Управление логическими томами"
author: "Максат Хемраев"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки управления логическими томами.

# Отчёт по выполнению работы

## Создание физического тома

1. Работа началась с создания нового раздела на диске **/dev/sdb**.  
   Был добавлен основной раздел размером 300 MiB, а также удалена существующая сигнатура XFS.

   ![Создание раздела sdb1](Screenshot_1.png){ #fig:001 width=80% }

2. Тип раздела был изменён на *Linux LVM (8e)*. Таблица разделов записана на диск, после чего информация обновлена в ядре.  
   Далее раздел был преобразован в физический том.

   ![Создание физического тома LVM](Screenshot_2.png){ #fig:002 width=80% }

3. После проверки убедились, что новый физический том успешно распознан системой.

---

## Создание группы томов и логических томов

1. Созданный физический том был добавлен в новую группу томов **vgdata**.  
   Проверка показала корректное создание группы и привязку физического тома.

   ![Создание группы томов vgdata](Screenshot_3.png){ #fig:003 width=80% }

2. Затем внутри группы был создан логический том **lvdata**, использующий 50% свободного пространства.  

3. На логическом томе создана файловая система ext4, после чего была добавлена строка в `/etc/fstab` для автоматического монтирования.  
   Папка `/mnt/data` создана заранее.

   ![Создание файловой системы и запись в fstab](Screenshot_4.png){ #fig:004 width=80% }

4. Проверка монтирования показала, что том успешно подключён.

   ![Проверка монтирования тома](Screenshot_5.png){ #fig:005 width=80% }

---

## Расширение группы томов и изменение размера логического тома

1. На диске `/dev/sdb` был создан ещё один раздел — **/dev/sdb2**, также размером 300 MiB и с типом 8e.

   ![Создание второго раздела sdb2](Screenshot_6.png){ #fig:006 width=80% }

2. Новый раздел преобразован в физический том и добавлен в группу томов **vgdata**, что позволило увеличить доступный объём.

   ![Добавление sdb2 в vgdata](Screenshot_7.png){ #fig:007 width=80% }

3. После проверки стало видно, что общий размер группы томов увеличился.

4. Логический том **lvdata** был расширен на 50% свободного пространства группы томов.  
   Файловая система увеличена автоматически.

   ![Увеличение размера lvdata](Screenshot_8.png){ #fig:008 width=80% }

5. Затем размер логического тома был уменьшён на 50 MiB, после чего он был смонтирован обратно.

   ![Уменьшение размера lvdata](Screenshot_9.png){ #fig:009 width=80% }

---

# Отчёт по выполнению самостоятельной работе

## Создание логического тома lvgroup

1. На диске **/dev/sdc** были созданы два новых раздела: один размером 600 МБ и второй 450 МБ.  
   Оба раздела получили тип *Linux LVM (8e)*, после чего таблица разделов была записана на диск.

   ![Разметка диска sdc](Screenshot_10.png){ #fig:010 width=80% }

2. Первый раздел был преобразован в физический том, на его основе создана группа томов **vggroup**, затем — логический том **lvgroup** размером 200 МБ.  
   Проверка структуры LVM показала успешное создание всех элементов.

   ![Создание PV, VG и LV](Screenshot_11.png){ #fig:011 width=80% }

3. На логическом томе была создана файловая система XFS.  
   Подключение тома планировалось к каталогу `/mnt/groups`, который был создан заранее.

   ![Создание файловой системы XFS](Screenshot_12.png){ #fig:012 width=80% }

4. В файл `/etc/fstab` была добавлена строка автоматического монтирования.  
   После записи изменений том был смонтирован и успешно определился в списке подключённых устройств.

   ![Правка fstab и проверка монтирования](Screenshot_13.png){ #fig:013 width=80% }

---

## Расширение логического тома lvgroup

1. Второй раздел **/dev/sdc2** был преобразован в физический том и добавлен в группу томов **vggroup**, что увеличило её доступный объём.

   ![Добавление второго PV в группу томов](Screenshot_14.png){ #fig:014 width=80% }

2. Логический том **lvgroup** был увеличен на 150 МБ.  
   Файловая система XFS была увеличена автоматически, так как этот тип поддерживает онлайн-расширение.

   ![Расширение тома и файловой системы](Screenshot_15.png){ #fig:015 width=80% }

3. Проверка состояния групп, физических и логических томов, а также вывод информации о файловых системах показали, что расширение тома и файловой системы выполнено корректно и успешно.

   ![Проверка итоговой конфигурации](Screenshot_16.png){ #fig:016 width=80% }

# Контрольные вопросы

### 1. Какой тип раздела используется в разделе GUID для работы с LVM?

* Для LVM в GUID-разметке используется **тип раздела `8e00` (Linux LVM)**.

---

### 2. Какой командой можно создать группу томов с именем vggroup, которая содержит физическое устройство /dev/sdb3 и использует физический экстент 4 MiB?

* Используется команда создания группы томов с указанием размера экстента:

```bash
vgcreate -s 4M vggroup /dev/sdb3
```

---

### 3. Какая команда показывает краткую сводку физических томов в вашей системе, а также группу томов, к которой они принадлежат?

* Сводку физических томов показывает команда:

```bash
pvs
```

---

### 4. Что нужно сделать, чтобы добавить весь жёсткий диск /dev/sdd в группу томов?

* Сначала нужно создать физический том на всём диске:

```bash
pvcreate /dev/sdd
```

* Затем добавить его в группу томов:

```bash
vgextend <имя_VG> /dev/sdd
```

---

### 5. Какая команда позволяет создать логический том lvvol1 размером 6 MiB?

* Создание логического тома фиксированного размера:

```bash
lvcreate -n lvvol1 -L 6M <имя_VG>
```

---

### 6. Какая команда позволяет добавить 100 МБ в логический том lvvol1, если пространство доступно в группе томов?

* Увеличение логического тома:

```bash
lvextend -L +100M /dev/<VG>/lvvol1
```

---

### 7. Каков первый шаг, чтобы добавить ещё 200 МБ дискового пространства в логический том, если требуемое место отсутствует в группе томов?

* Необходимо **расширить группу томов**, добавив новый физический том:

```bash
pvcreate /dev/<новый_раздел>
vgextend <VG> /dev/<новый_раздел>
```

---

### 8. Какую опцию нужно использовать с командой lvextend, чтобы также изменить размер файловой системы?

* Используется опция:

```bash
lvextend -r
```

* Она автоматически расширяет и файловую систему.

---

### 9. Как посмотреть, какие логические тома доступны?

* Просмотр доступных логических томов:

```bash
lvs
```

---

### 10. Какую команду нужно использовать для проверки целостности файловой системы на /dev/vgdata/lvdata?

* Для проверки файловой системы ext4 используется:

```bash
e2fsck -f /dev/vgdata/lvdata
```

* Для XFS:

```bash
xfs_repair /dev/vgdata/lvdata
```

# Заключение

В ходе работы были созданы и изменены физические, групповые и логические тома LVM, а также выполнено их форматирование, подключение и расширение. Выполненные операции продемонстрировали базовые приёмы управления дисковым пространством и динамического изменения его структуры в Linux.
