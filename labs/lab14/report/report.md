---
## Front matter
title: "Отчёт по лабораторной работе №14"
subtitle: "Партиции, файловые системы, монтирование"
author: "Максат Хемраев"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Получить навыки создания разделов на диске и файловых систем. Получить навыки монтирования файловых систем.

# Отчёт по выполнению работы  

## Создание разделов MBR с помощью *fdisk*

1. В виртуальной машине были добавлены два дополнительных диска — **disk1** и **disk2**.  
   В командной строке от имени администратора выполнена проверка всех подключённых устройств хранения с помощью команды `fdisk -l`.  
   Отобразились сведения о дисках: основной диск **/dev/sda** (40 ГиБ) и два дополнительных — **/dev/sdb** и **/dev/sdc** по 1,5 ГиБ каждый.  

   ![Просмотр всех устройств хранения](Screenshot_1.png){ #fig:001 width=80% }

2. Для начала работы с первым дополнительным диском **/dev/sdb** была запущена утилита **fdisk**.  
   После запуска утилита сообщила об отсутствии таблицы разделов и автоматически создала новую с типом **DOS (MBR)**.  
   Для получения справки по доступным командам введена команда **m**.  

   ![Справка по командам fdisk](Screenshot_2.png){ #fig:002 width=80% }

3. С помощью команды **p** был выведен текущий статус таблицы разделов. Затем создан новый основной раздел, указав тип **p** и размер **300 МиБ**.  
   После подтверждения изменений с помощью команды **w** таблица разделов была сохранена.  

   ![Создание основного раздела на /dev/sdb](Screenshot_3.png){ #fig:003 width=80% }

4. Проверка содержимого показала наличие нового раздела **/dev/sdb1**. Дополнительно выведено содержимое файла **/proc/partitions** и выполнена команда **partprobe**, чтобы обновить таблицу разделов ядра.  

   ![Проверка созданного раздела /dev/sdb1](Screenshot_4.png){ #fig:004 width=80% }

---

## Создание расширенного и логического разделов

1. В утилите **fdisk** был добавлен расширенный раздел с типом **e** размером 1,2 ГиБ, после чего создан логический раздел **/dev/sdb5** размером 300 МиБ.  
   Все изменения были записаны командой **w**.  

   ![Создание расширенного и логического разделов](Screenshot_5.png){ #fig:005 width=80% }

2. После обновления таблицы разделов ядра с помощью **partprobe** и повторной проверки через **cat /proc/partitions** и **fdisk -l** отобразились три раздела:  
   - **/dev/sdb1** — основной (300 МиБ);  
   - **/dev/sdb2** — расширенный (1,2 ГиБ);  
   - **/dev/sdb5** — логический (300 МиБ).  

   ![Результат проверки после создания расширенного и логического разделов](Screenshot_6.png){ #fig:006 width=80% }

---

## Создание раздела подкачки (swap)

1. В том же диске **/dev/sdb** был создан ещё один логический раздел **/dev/sdb6** размером **300 МиБ**.  
   С помощью команды **t** его тип был изменён с *Linux (83)* на *Linux swap / Solaris (82)*.  

   ![Создание и изменение типа раздела подкачки](Screenshot_7.png){ #fig:007 width=80% }

2. Проверка структуры диска подтвердила, что раздел **/dev/sdb6** имеет тип *82 (Linux swap / Solaris)*.  

   ![Проверка разделов с типом swap](Screenshot_8.png){ #fig:008 width=80% }

3. Далее раздел **/dev/sdb6** был отформатирован под подкачку и активирован.  
   Проверка через **free -m** показала увеличение доступного пространства подкачки.  

   ![Создание и активация раздела подкачки](Screenshot_9.png){ #fig:009 width=80% }

---

## Создание разделов GPT с помощью *gdisk*

1. В терминале с правами администратора была запущена команда `gdisk -l /dev/sdc` для просмотра таблицы разделов второго дополнительного диска.  
   Утилита показала, что на диске отсутствуют таблицы разделов, после чего автоматически создала новую таблицу **GPT** в памяти.  

   ![Проверка таблицы разделов и создание GPT](Screenshot_10.png){ #fig:010 width=80% }

2. Далее была запущена утилита **gdisk /dev/sdc** для создания раздела.  
   С помощью команды **n** был добавлен новый раздел номер **1** размером **300 МиБ** и типом **8300 (Linux filesystem)**.  
   После проверки структуры командой **p** и записи изменений с помощью **w**, новая таблица разделов была сохранена на диск.  

   ![Создание раздела в gdisk](Screenshot_11.png){ #fig:011 width=80% }

3. Проверка через команды **cat /proc/partitions** и **gdisk -l /dev/sdc** показала, что на диске создан раздел **/dev/sdc1** размером **300 МиБ** с типом *Linux filesystem*.  

   ![Проверка созданного GPT-раздела](Screenshot_12.png){ #fig:012 width=80% }

---

## Форматирование файловых систем XFS и EXT4

1. На разделе **/dev/sdb1** была создана файловая система **XFS**.  
   После форматирования при помощи **mkfs.xfs /dev/sdb1** установлена метка тома **xfsdisk** через команду **xfs_admin -L xfsdisk /dev/sdb1**.  

2. На разделе **/dev/sdb5** была создана файловая система **EXT4** с помощью команды **mkfs.ext4 /dev/sdb5**.  
   Затем с помощью **tune2fs -L ext4disk /dev/sdb5** задана метка **ext4disk**, а командой **tune2fs -o acl,user_xattr /dev/sdb5** включены списки контроля доступа и расширенные атрибуты.  

   ![Форматирование XFS и EXT4, установка меток](Screenshot_13.png){ #fig:013 width=80% }

---

## Ручное монтирование файловых систем

1. Создана точка монтирования **/mnt/tmp**, после чего раздел **/dev/sdb5** был временно смонтирован в неё.  
   Проверка через команду **mount** подтвердила успешное монтирование.  
   После тестирования раздел был отмонтирован.  

   ![Ручное монтирование и отмонтирование EXT4](Screenshot_14.png){ #fig:014 width=80% }

---

## Монтирование файловых систем через /etc/fstab

1. Для раздела **/dev/sdb1** была создана постоянная точка монтирования **/mnt/data**.  
   Затем при помощи **blkid** получены UUID всех разделов, включая **xfsdisk** и **ext4disk**, что позволило внести их в конфигурацию **/etc/fstab**.  

   ![Проверка UUID всех разделов](Screenshot_15.png){ #fig:015 width=80% }

2. В файл **/etc/fstab** добавлена строка для автоматического монтирования раздела **/dev/sdb1** с файловой системой **XFS**.  
   Строка имеет вид: `UUID=b4dca600-1e99-4e4f-977f-848ffbab7101 /mnt/data xfs defaults 1 2`
   
После сохранения изменений команда **mount -a** проверила корректность конфигурации.  

![Редактирование файла /etc/fstab](Screenshot_16.png){ #fig:016 width=80% }

3. Команда **df -h** показала, что раздел **/dev/sdb1** успешно примонтирован в каталог **/mnt/data**.  

![Проверка монтирования через df -h](Screenshot_17.png){ #fig:017 width=80% }

## Самостоятельная работа: создание разделов GPT и настройка автоматического монтирования  

1. На диске **/dev/sdc** с таблицей разделов **GPT** были созданы два новых раздела по 300 МиБ каждый.  
   Первый раздел (**/dev/sdc2**) предназначен для файловой системы **ext4**, второй (**/dev/sdc3**) — для области подкачки (*swap*).  
   Для этого в утилите **gdisk** выполнено добавление разделов с типами **8300 (Linux filesystem)** и **8200 (Linux swap)** соответственно.  
   После проверки командой **p** и записи изменений с помощью **w** структура таблицы была сохранена на диск.  

   ![Создание разделов ext4 и swap на GPT-диске](Screenshot_18.png){ #fig:018 width=80% }

2. Для раздела **/dev/sdc2** была создана файловая система **ext4**, присвоена метка **ext4disk2**, а также включены атрибуты **acl** и **user_xattr**.  
   Раздел **/dev/sdc3** был отформатирован как область подкачки при помощи **mkswap**.  
   После форматирования и проверки через **blkid** определены UUID созданных разделов.  

   ![Форматирование разделов ext4 и swap](Screenshot_19.png){ #fig:019 width=80% }

3. В конфигурационный файл **/etc/fstab** были добавлены записи для автоматического монтирования:  
   - раздел **/dev/sdc2** монтируется в каталог **/mnt/data-ext** с типом **ext4**;  
   - раздел **/dev/sdc3** используется как пространство подкачки **swap**.  

   ![Редактирование файла /etc/fstab для автоматического монтирования](Screenshot_20.png){ #fig:020 width=80% }

4. После применения изменений с помощью команд **mount -a** и **systemctl daemon-reload**, проверка вывода **df -h** и **free -m** показала, что разделы были успешно примонтированы и активированы:  
   - **/dev/sdb1** смонтирован в **/mnt/data** (XFS);  
   - **/dev/sdc2** смонтирован в **/mnt/data-ext** (EXT4);  
   - область подкачки **/dev/sdc3** успешно задействована.  

   ![Проверка монтирования и состояния swap](Screenshot_21.png){ #fig:021 width=80% }

# Контрольные вопросы

### 1. Какой инструмент используется для создания разделов GUID?
- Для создания разделов с таблицей **GUID (GPT)** используется утилита **gdisk**.

---

### 2. Какой инструмент применяется для создания разделов MBR?
- Для работы с разделами в формате **MBR** применяется утилита **fdisk**.

---

### 3. Какой файл используется для автоматического монтирования разделов во время загрузки?
- Для автоматического монтирования используется файл конфигурации **/etc/fstab**.

---

### 4. Какой вариант монтирования целесообразно выбрать, если необходимо, чтобы файловая система не была автоматически примонтирована во время загрузки?
- В файле **/etc/fstab** необходимо указать параметр **noauto** — он предотвращает автоматическое монтирование при старте системы.

---

### 5. Какая команда позволяет форматировать раздел с типом 82 с соответствующей файловой системой?
- Раздел с типом **82 (Linux swap)** форматируется командой  
  **`mkswap /dev/имя_раздела`**.

---

### 6. Вы только что добавили несколько разделов для автоматического монтирования при загрузке. Как можно безопасно проверить, будет ли это работать без реальной перезагрузки?
- Для проверки корректности конфигурации используется команда  
  **`mount -a`**, которая монтирует все разделы, указанные в **/etc/fstab**, без перезагрузки системы.

---

### 7. Какая файловая система создаётся, если вы используете команду mkfs без какой-либо спецификации файловой системы?
- Если не указать тип файловой системы, команда **mkfs** создаст файловую систему **ext2** по умолчанию.

---

### 8. Как форматировать раздел EXT4?
- Форматирование выполняется командой  
  **`mkfs.ext4 /dev/имя_раздела`**.

---

### 9. Как найти UUID для всех устройств на компьютере?
- Для вывода UUID всех блочных устройств используется команда  
  **`blkid`**.

---

# Заключение

В ходе работы были изучены принципы разметки дисков с таблицами разделов **MBR** и **GPT**, а также освоены инструменты **fdisk** и **gdisk** для их создания и управления.  
Были сформированы и отформатированы разделы с файловыми системами **XFS** и **EXT4**, создан раздел подкачки **swap**, а также выполнена настройка автоматического монтирования через файл **/etc/fstab**.  
